# Dungeon

The Dungeon module controls the procedural building (spawning) of the [DungeonMap](./dungeon_map/dungeon_map.rs) based on various strategies. It also has systems for revealing the dungeon in response to the `RevealDungeonEvent` and handling zooming into and out of the local player's map view. Finally, it implements the [Illuminator](./illuminator.rs) helper to illuminate or darken tiles based on the local player's field of view (FOV).

The `DungeonMap` is generated when entering the `GameState::DungeonSpawning` state, at which time the newly generated dungeon is populated with players, items and monsters. To be more precise, the `DungeonMap` represents only the active Level of play. Game play starts at level 1. When a player enter a tile with [ExitStairs](./components.rs), the [exit_level](../player/player_actions/exit_level.rs) system transitions to `GameState::DungeonSpawning` (see [OnEnter(GameState::DungeonSpawning)](../../README.md#onentergamestatedungeonspawning)). At this point, a new `DungeonMap` is generated and populated for the new level. This happens for BOTH players.
